<div class="alert alert-success alert-dismissible rounded-0 fade show" role="alert" *ngIf="showSuccessAlert">
  Competenza aggiunta con successo!
  <button type="button" class="btn-close m-0" aria-label="Close" (click)="closeAlert()"></button>
</div>
<div class="alert alert-danger rounded-0 alert-dismissible fade show alert-message m-0" role="alert" *ngIf="showErrorAlert">
  Si è verificato un errore durante l'aggiunta della competenza.
  <button type="button" class="btn-close" aria-label="Close" (click)="closeAlert()"></button>
</div>

<div class="container-fluid">
  <div class="row">
<form class="p-4 text-center" [formGroup]="competenzaForm" (ngSubmit)="onCompetenzaSubmit()">
  <h2>Crea la competenzza opportuna per la macchina</h2>
  <div class="d-flex justify-content-center align-content-center ">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12"> 
          <div class="d-flex flex-column text-center m-2">
            <label for="competenzaNome" class="form-label">Nome Competenza</label>
            <input type="text" class="form-control" id="competenzaNome" formControlName="nomeCompetenza">
            <!-- Spazio riservato per il messaggio di errore -->
            <div [class.d-none]="!competenzaForm.get('nomeCompetenza')?.invalid || !competenzaForm.get('nomeCompetenza')?.touched" class="text-secondary" style="height: 50px;">
              <div *ngIf="competenzaForm.get('nomeCompetenza')?.invalid && competenzaForm.get('nomeCompetenza')?.touched">
                Il campo Nome Competenza è richiesto.
              </div>
            </div>
          </div>
        </div>
   <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12"> 
     <div class="d-flex flex-column text-center m-2">
       <label for="competenzamachineId" class="form-label">Scegli macchina</label>
       <select class="form-control" id="competenzamachineId" formControlName="machineId">
         <ng-container *ngFor="let macchina of macchine">
           <option *ngIf="!macchina.competenza" [value]="macchina.id" class="d-flex justify-content-between text-center">
             
             <span>{{ macchina.nomeMacchina }}</span>
             <span>-{{ macchina.marca }}</span>
             <span> -{{ macchina.modello }}</span>
             
            </option>
          </ng-container>
        </select>
        <div [class.d-none]="!competenzaForm.get('machineId')?.invalid || !competenzaForm.get('machineId')?.touched" class="text-secondary" style="height: 50px;">
          <div *ngIf="competenzaForm.get('machineId')?.invalid && competenzaForm.get('machineId')?.touched">
            Il campo Risorsa è richiesto.
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12"> 
      <div class="d-flex flex-column text-center m-2">
        <label for="UserCompetenza" class="form-label">Scegli User</label>
        <select class="form-control" id="UserCompetenza" formControlName="userId">
          <ng-container *ngFor="let user of userDati">
            <option  [value]="user.id" class="d-flex justify-content-between text-center">
              
              <span>{{ user.nome }}</span>
              <span>{{ user.cognome }}</span>
              <span> -{{ user.email }}</span>
              
            </option>
          </ng-container>
        </select>
        <div [class.d-none]="!competenzaForm.get('userId')?.invalid || !competenzaForm.get('userId')?.touched" class="text-secondary" style="height: 50px;">
          <div *ngIf="competenzaForm.get('userId')?.invalid && competenzaForm.get('userId')?.touched">
            Il campo User è richiesto.
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12"> 
      <div class="d-flex flex-column text-center m-2">
        <label for="competenzaDescrizione" class="form-label">Descrizione</label>
        <textarea class="form-control" id="competenzaDescrizione" formControlName="descrizione" rows="3"></textarea>
        <div class="text-secondary" style="min-height: 50px;">
          <div *ngIf="competenzaForm.get('descrizione')?.invalid && competenzaForm.get('descrizione')?.touched" class="d-block">
            Il campo Descrizione è richiesto.
          </div>
        </div>
      </div>
    </div>

  <div class="row justify-content-center">
    <div class="col-md-6 d-flex flex-column justify-content-end">
    <label for="competenzaLivello" class="form-label">Livello</label>
      <input type="number" class="form-control w-25 m-auto" id="competenzaLivello" formControlName="livello">
      <div [class.d-none]="!competenzaForm.get('livello')?.invalid || !competenzaForm.get('livello')?.touched" class="text-secondary" style="height: 50px;">
        <div *ngIf="competenzaForm.get('livello')?.invalid && competenzaForm.get('livello')?.touched">
          Il campo Livello è richiesto.
        </div>
      </div>
  </div>

    <div class="col-md-6 d-flex justify-content-start align-items-center m-0">
      <button type="submit" class="btn btn-dark my-3">Aggiungi Competenza</button>
    </div>
  </div>
      </div>
    </div>
  </div>
</form>
</div>
</div>